#!/usr/bin/env bash

DROIDCAM_IP="${DROIDCAM_IP:-192.168.1.84}"
DROIDCAM_PORT="${DROIDCAM_PORT:-"4747"}"

droidcam_start() {
  DROIDCAM_IP="${1:-$DROIDCAM_IP}"
  DROIDCAM_PORT="${2:-$DROIDCAM_PORT}"
  systemd-run --user --unit=droidcam /usr/bin/droidcam-cli $DROIDCAM_IP $DROIDCAM_PORT
}

droidcam_stop() {
  systemctl --user stop droidcam
}

droidcam_help() {
  echo "camutils"
  echo "usage:"
  echo "  start droidcam service"
  echo "    camutils up <ip> <port>"
  echo "  stop droidcam service"
  echo "    camutils down"
}

case $1 in
  up)
    droidcam_start $2 $3
    ;;
  down)
    droidcam_stop
    ;;
  *)
    droidcam_help
    ;;
esac
